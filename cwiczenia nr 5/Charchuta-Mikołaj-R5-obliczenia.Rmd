---
title: "Regresja"
author: "Charchuta — Mikołaj"
output: html_document
---

---

## Zadanie 1 — korelacja mąka (M) vs cukier (C)

Obliczyć i przetestować współczynnik korelacji między spożyciem obu artykułów.

```{r zad1, echo=TRUE}
# Dane
M <- c(15,20,25,30,35,50)
C <- c(15,25,30,35,45,50)

data.frame(M, C)
plot(M, C, pch=19, xlab = "Mąka (kg)", ylab = "Cukier (kg)", main = "Korelacja M vs C")

# Pearson correlation and test
cor(M, C)
cor.test(M, C, method = "pearson")

# Spearman as robustness check
cor.test(M, C, method = "spearman")
```

Krótka interpretacja: sprawdź estymatę r i p-value z cor.test. Jeśli p < 0.05 -> istotna korelacja liniowa.

---

## Zadanie 2 — korelacja substancji A i B

```{r zad2, echo=TRUE}
A <- c(0.6,0.2,0.3,0.7,0.5,0.8,0.7,0.4,0.6,0.8)
B <- c(1.5,1.5,1.1,1.2,1.4,1.1,1.6,1.0,1.9,1.7)

plot(A, B, pch=19, xlab = "A (mg/kg)", ylab = "B (mg/kg)", main = "Korelacja A vs B")
cor(A, B)
cor.test(A, B, method = "pearson")
cor.test(A, B, method = "spearman")
```

Interpretacja: sprawdź r i p-value; jeśli p < 0.05 — statystycznie istotna korelacja.

---

## Zadanie 3 — tablica kontyngencji (Parch vs Owocówka)

Tabela:

```{r zad3, echo=TRUE}
# Macierz: wiersze = Parch (C, P), kolumny = Owocówka (U, N)
tab3 <- matrix(c(29,194,17,68), nrow = 2, byrow = TRUE)
rownames(tab3) <- c("Czyste","Plamki")
colnames(tab3) <- c("U","N")
tab3

# Chi-squared test (H0: niezależność)
chisq.test(tab3, correct = FALSE)

# Jeśli oczekiwane są małe, rozważyć test Fishera (tu n duże więc chi2 OK)
```

Wnioski: porównać p-value z alfa = 0.01.

---

## Zadanie 4 — wykształcenie vs zarobki (tablica kontyngencji)

```{r zad4, echo=TRUE}
# Wiersze: kategorie zarobków; kolumny: wykształcenie
tab4 <- matrix(c(
 21,41,93,47,
 33,37,35,53,
 45,75,27,43,
 30,48,50,55,
 71,47,49,50
), nrow = 5, byrow = TRUE)
rownames(tab4) <- c("<500","500-1000","1000-1500","1500-2000",">2000")
colnames(tab4) <- c("podstawowe","średnie","wyższe","ponad_wyższe")
tab4

chisq.test(tab4)
```

Interpretacja: jeśli p < 0.05 (albo inna ustalona alfa), odrzucamy niezależność — istnieje związek między wykształceniem a zarobkami.

---

## Zadanie 5 — oceny dwóch kaw


```{r zad5, echo=TRUE}
# Dane
ratings <- c(3,4,5,6,7)
szatanex <- c(4,14,17,19,6)
lurekcja  <- c(6,16,21,13,4)

# 2x5 tablica: wiersze = kawa, kolumny = ocena
tab5 <- rbind(Szatanex = szatanex, Lurekcja = lurekcja)
colnames(tab5) <- as.character(ratings)
tab5

# Test chi-kwadrat (H0: rozkład ocen niezależny od typu kawy)
chisq.test(tab5, correct = FALSE)

# Alternatywnie z symulacją dokładnego p-value (przydatne gdy oczekiwane są małe)
chisq.test(tab5, simulate.p.value = TRUE, B = 10000)
```

---

## Zadanie 6 — regresja: zawartość wody vs dni przechowywania

```{r zad6, echo=TRUE}
dni <- 1:7
w <- c(49,47.5,47,46.5,44.5,44,45)
plot(dni, w, pch=19, xlab = "Dni przechowywania", ylab = "Zawartość wody (%)")
mod6 <- lm(w ~ dni)
summary(mod6)
coef(mod6)
cor.test(dni, w)

# Porównać estymatę z podanym wynikiem y = 49.29 - 0.77 x
```

---

## Zadanie 7 — regresja: obroty Y vs liczba sprzedawców X

```{r zad7, echo=TRUE}
X <- c(1,2,3,4,5,6,6)
Y <- c(1.2,2.2,3,3.5,4,5,6)
plot(X, Y, pch=19, xlab = "Liczba sprzedawców", ylab = "Obroty (tys. zł)")
mod7 <- lm(Y ~ X)
summary(mod7)
coef(mod7)
cor.test(X, Y)

# Porównać z odpowiedzią y = 0.43 + 0.81 x
```

---

## Zadanie 8 — regresja: kaloryczność vs zawartość tłuszczu

```{r zad8, echo=TRUE}
fat <- c(2.0,2.5,2.9,3.6,4.0,4.5,5.0)
kal <- c(40,48,50,52,60,65,68)
plot(fat, kal, pch=19, xlab = "% tłuszczu", ylab = "kcal/100g")
mod8 <- lm(kal ~ fat)
summary(mod8)
coef(mod8)
cor.test(fat, kal)

# Porównać z odpowiedzią y = 23.16 + 9.02 x
```

---

## Zadanie 9 — regresja: straty witaminy C vs czas moczenia

```{r zad9, echo=TRUE}
time <- c(0.5,1,2,5,10)
loss <- c(5,7,9,11,13)
plot(time, loss, pch=19, xlab = "Czas moczenia (h)", ylab = "Straty witaminy C (%)")
mod9 <- lm(loss ~ time)
summary(mod9)
coef(mod9)
cor.test(time, loss)
```

---

## Zadanie 10 — regresja: sprzedaż vs czas reklamy

```{r zad10, echo=TRUE}
time_adv <- c(5,6,10,2,8,9)
sales <- c(2,2.1,2.5,1.6,2.3,2.5)
plot(time_adv, sales, pch=19, xlab = "Czas reklamy (min/tydz)", ylab = "Sprzedaż (tys. kg)")
mod10 <- lm(sales ~ time_adv)
summary(mod10)
coef(mod10)
cor.test(time_adv, sales)
```

---

## Zadanie 11 — regresja wielokrotna (plon od 3 cech)

```{r zad11, echo=TRUE}
# Dane (30 obserwacji)
Plon <- c(23.5,19.3,15.7,21.5,27.29,24.66,33.1,33.6,38.8,32.3,47.49,38.24,27.08,42.50,30.00,26.25,19.6,14.6,14.4,20,23.62,28.53,37.8,30.0,35.4,31.5,54.39,51.74,37.50,42.50)
DlugoscLuszczyn <- c(58.28,64.24,69.28,61.00,61.12,71.00,58.2,65.1,57.6,50.4,86.3,70.2,65.2,74.2,63.8,60.6,48.80,53.08,50.60,65.52,62.14,52.72,60.2,58.3,67.2,59.8,87.4,60.8,70.0,61.4)
ZawartoscTluszczu <- c(38.30,38.50,37.80,38.80,44.3,45.4,47.1,46.6,45.6,43.4,44.0,44.5,44.3,44.5,45.3,46.1,36.20,35.50,34.60,35.80,44.2,45.0,46.2,46.6,44.6,44.0,43.8,44.0,45.5,44.6)
SumaGlukozynolanow <- c(13.7,10.8,16.6,12.2,12.5,9.2,5.6,5.5,6.1,6.0,6.4,10.0,11.2,13.1,8.2,8.5,14.6,13.3,14.4,9.0,13.7,12.8,5.6,6.0,6.8,6.5,11.4,10.7,7.8,10.0)

df11 <- data.frame(Plon, DlugoscLuszczyn, ZawartoscTluszczu, SumaGlukozynolanow)
head(df11)

mod11 <- lm(Plon ~ DlugoscLuszczyn + ZawartoscTluszczu + SumaGlukozynolanow, data = df11)
summary(mod11)
coef(mod11)

# Porównać z podanym wzorem: Plon = -51.0 + 0.47*Dlugosc + 1.30*Zawartosc - 0.35*Suma
```
